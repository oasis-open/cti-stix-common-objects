:stylesheet: stix.css
:stylesdir: ../../asciidoc-shared
:toc: macro
:nofooter:

= [stixtitle]*Event Extension Version 1.0 for STIX^TM^ Version 2.1*

[.stix-doc-information-heading]#Draft#

[.stix-doc-information-heading]#26 March 2023#

[.stix-doc-information-heading]
Editors:
[.stix-indent]
* IMG - Incident Mini Group


[.stix-doc-information-heading]
Additional artifacts:
[.stix-indent]
.This prose specification is one component of a Work Product that also includes:

- STIX™ Version 2.1 - OS
- Impact Extension Version 1.0 for STIX^TM^ Version 2.1
- Incident Core Extension Version 2.0 for STIX^TM^ Version 2.1
- Task Extension Version 1.0 for STIX^TM^ Version 2.1


[.stix-doc-information-heading]
Related work:

- https://www.misp-project.org/taxonomies.html

[.stix-indent]
.This specification replaces or supersedes: +

- N/A

toc::[]

[.stix-doc-information-heading]*Abstract:*

The current STIX 2.1 Incident object exists as a stub in the hopes that future work would allow STIX Incidents to be more fully fleshed out using extensions, and that in time a set of core features could be defined to be migrated into a future version of the Incident object or the community could arrive at the consensus to continue to use these extensions.

This extension is focused on recording attacker, defender, and other related activities that occur during an incident and prior to an incident being declared.
This extension also provides both new means and examples of connections to a number of existing STIX Objects in order to facilitate highly interoperable verbose reporting that does not overburden analysts to initially generate or maintain.

== 1. Events in STIX

Events represent things that have ocurred or are expected to occur that could impact an organization.
Events can store a list of sub-events that can be optionally ordered to provide greater fidelity.
Events often take place prior to an incident being declared, and events with impacts or suspected impacts often lead to incidents being created.

<<<

== 2. Event Extension

[width="100%",cols="100%",stripes=odd]
|===
^|[stixtr]*Required Common Properties*
|*created*,
*id*,
*modified*,
*spec_version*,
*type*

^|[stixtr]*Optional Common Properties*

|*created_by_ref*,
*revoked*,
*labels*,
*confidence*,
*lang*,
*external_references*,
*object_marking_refs*,
*granular_markings*,
*extensions*

^|[stixtr]*Not Applicable Common Properties*

|*defanged*

^|[stixtr]*Event Object Specific Properties*

|*changed_objects*,
*description*,
*end_time*,
*end_time_fidelity*,
*event_types*,
*goal*,
*kill_chain_phases*
*name*,
*status*,
*pattern_refs*,
*sighting_refs*,
*start_time*,
*start_time_fidelity*,
*subevents*
|===

|===
^|[stixtr]*Property Name* ^|[stixtr]*Type* ^|[stixtr]*Description*

|*status* (required)
|[stixtype]#event-status-enum#
|The current status of the event.

|*type* (required)
|[stixtype]#string#
|The value of this property *MUST* be set to [stixliteral]#event#.

|*changed_objects* (optional)
|[stixtype]#list# of type [stixtype]#state-change#
|A list of changes that this event has caused.
This is typically used to indicate how an event has affected impacts.

|*description* (optional)
|[stixtype]#string#
|A description of event that occurred.

|*end_time* (optional)
|[stixtype]#timestamp#
|The date and time the event was last recorded. If this is not present it is assumed to be unknown.

|*end_time_fidelity* (optional)
|[stixtype]#timestamp-fidelity-enum#
|The level of fidelity that the end_time is recorded in.
This value *MUST* come from [stixtype]#timestamp-fidelity-enum#.

If no value is provided the timestamp should be considered to be accurate up to the number of decimals it includes.

|*event_types* (optional)
|[stixtype]#list# of type [stixtype]#open-vocabulary#
|High level types for the event in order to enable aggregation and summaries.
This should be drawn from event-type-ov.

|*goal* (optional)
|[stixtype]#string#
|The assumed objective of this event.
Not all events have goals.

|*kill_chain_phases* (optional)
|[stixtype]#list# of type [stixtype]#kill-chain-phase#
|The kill chain phase(s) to which this event corresponds.

|*name* (optional)
|[stixtype]#string#
|An optional name for the event.

|*pattern_refs* (optional)
|[stixtype]#list# of type [stixtype]#identifier#
|An optional list of attack patterns or attacker playbooks that were demonstrated by the event.

|*sighting_refs* (optional)
|[stixtype]#list# of type [stixtype]#identifier#
|An optional list of sightings that were related to this event.
Sightings referenced in this *SHOULD* be based on Indicator or Malware SDOs.

In some cases observed data may be present, but no Indicator can be created.
In these cases it is appropriate to have the Sighting use the Event itself as its *sighting_of_ref*.

|*start_time* (optional)
|[stixtype]#timestamp#
|The date and time the event was first recorded. If this is not
present it is assumed to be unknown.

This property *SHOULD* be populated.

|*start_time_fidelity* (optional)
|[stixtype]#timestamp-fidelity-enum#
|The level of fidelity that the start_time is recorded in. This value
*MUST* come from [stixtype]#timestamp-fidelity-enum#.

If no value is provided the timestamp should be considered to be
accurate up to the number of decimals it includes.

|*subevents* (optional)
|[stixtype]#list# of type [stixtype]#event-sequence#
|A list of sub-event that this event was composed of.
|===

<<<

=== 2.1 Event-Sequence Object Type

*Type Name:* [stixtype]#event-sequence#

[width="100%",cols="37%,23%,40%",options="header",]
|===
^|[stixtr]*Property Name*
^|[stixtr]*Type* 
^|[stixtr]*Description*

|*event_ref* (required)
|[stixtype]#identifier# 
|This property specifies the event that ocurred at this point in the sequence.

The object referenced *MUST* be of type [stixtype]#event#.

|*sequence_end* (optional)
|[stixtype]#integer#
|An optional sequence number starting at 0 that shows the last point in an event is believed to have occurred relative to other [stixtype]#event-sequence# entries in the same list.

This *MUST NOT* be less than the [stixtype]*sequence_start* value, but the two can be equal.

|*sequence_start* (optional)
|[stixtype]#integer#
|An optional sequence number starting at 0 that shows the earliest point this event is believed to have occurred relative to other [stixtype]#event-sequence# entries in the same list.

This *MUST NOT* exceed the [stixtype]*sequence_end* value, but the two can be equal.
|===


=== 2.2 State Change Object Type

*Type Name:* [stixtype]#state-change#

The *initial_ref* or *result_ref* *MUST* be populated.

[width="100%",cols="37%,23%,40%",options="header",]
|===
^|[stixtr]*Property Name*
^|[stixtr]*Type* 
^|[stixtr]*Description*

|*state_change_type* (required)
|[stixtype]#open-vocabulary# 
|How this activity influenced the change in state between the *initial_ref* and *result_ref*.

This *SHOULD* be drawn from [stixtype]#state-change-type-ov#.

|*initial_ref* (optional)
|[stixtype]#identifier#
|The initial object state that this event affected.

If the *result_ref* is not populated then this *MUST* be populated.
If there is no result state this typically means that this event removed or resolved the initial object.
For example, an event or task resolved a network outage.

If both are present this indicates a transition between these states.
For example, a confidentiality impact was made worse as the information was shared further.

If the *result_ref* is populated this *MUST* reference the same type of SDO.

|*result_ref* (optional)
|[stixtype]#identifier#
|The final state that this event influenced.

If the *initial_ref* is not populated then this *MUST* be populated.
If there is no initial state it typically means that this event caused or created the result.
For example, an event causing a network outage.

If the *initial_ref* is populated this *MUST* reference the same type of SDO.

|===

<<<

== 3. Vocabularies

=== 3.1 Event Type Vocabulary

*Type Name*: [stixtype]#event-type-ov#

[width="100%",cols="31%,69%",options="header",]
|===
^|[stixtr]*Vocabulary Value* ^|[stixtr]*Description*

|[stixliteral]#aggregation-information-phishing-schemes#
|Collecting data obtained through phishing attacks on web pages, email accounts, etc...

|[stixliteral]#benign#
|The event was neither dangerous nor malicious and was not suspected to be malicious or dangerous.

|[stixliteral]#blocked#
|The event was suspected to be malicious and was blocked.

|[stixliteral]#brute-force-attempt#
|Unsuccessful login attempt by using sequential credentials for gaining access to the system.

|[stixliteral]#c&c-server-hosting#
|Web page disseminating one or various types of malware.

|[stixliteral]#confirmed#
|The event was confirmed to be tied to an incident and response is underway.

|[stixliteral]#connection-malware-port#
|System attempting to gain access to a port normally linked to a specific type of malware.

|[stixliteral]#connection-malware-system#
|System attempting to gain access to an IP address or URL normally linked to a specific type of malware, e.g. C&C or a distribution page for components linked to a specific botnet.

|[stixliteral]#content-forbidden-by-law#
|Distribution or sharing of illegal content such as child pornography, racism, xenophobia, etc...

|[stixliteral]#control-system-bypass#
|Unauthorized access to a system or component by bypassing an access control system in place.

|[stixliteral]#copyrighted-content#
|Distribution or sharing of content protected by copyright and related rights.

|[stixliteral]#data-exfiltration#
|Unauthorized access to and sharing of a specific set of information.

|[stixliteral]#deferred#
|The event is deferred due to resource constraints, information types or external reasons.

|[stixliteral]#deletion-information#
|Unauthorized deleting of a specific set of information.

|[stixliteral]#dictionary-attack-attempt#
|Unsuccessful login attempt by using system access credentials previously loaded into a dictionary.

|[stixliteral]#discarded#
|The event was discarded due to resource constraints, information types or external reasons.

|[stixliteral]#disruption-data-transmission#
|Logical and physical activities aimed at causing damage to information or at preventing its transmission among systems.

|[stixliteral]#dissemination-malware-email#
|Malware attached to a message or email message containing link to malicious URL.

|[stixliteral]#dissemination-phishing-emails#
|Mass emailing aimed at collecting data for phishing purposes with regard to the victims.

|[stixliteral]#dns-zone-transfer#
|Transfer of a specific DNS zone.

|[stixliteral]#duplicate#
|This event is a duplicate of another event.
A relationship should be created between this event and the event it duplicates.

|[stixliteral]#email-flooding#
|Sending an unusually large quantity of email messages.

|[stixliteral]#exploit#
|Successful use of a tool exploiting a specific vulnerability of the system.

|[stixliteral]#exploit-attempt#
|Unsuccessful use of a tool exploiting a specific vulnerability of the system.

|[stixliteral]#exploit-framework-exhausting-resources#
|Various sources using specially designed software to affect the normal functioning of a specific service, by exploiting a vulnerability.

|[stixliteral]#exploit-tool-exhausting-resources#
|One single source using specially designed software to affect the normal functioning of a specific service, by exploiting a vulnerability.

|[stixliteral]#failed#
|The event failed its suspected goal.

|[stixliteral]#file-inclusion#
|Inclusion of files into a system under attack with the use of file inclusion techniques.

|[stixliteral]#file-inclusion-attempt#
|Unsuccessful attempt to include files in the system under attack by using file inclusion techniques.

|[stixliteral]#hosting-malware-webpage#
| Web page disseminating one or various types of malware.

|[stixliteral]#hosting-phishing-sites#
|Hosting web sites for phishing purposes.

|[stixliteral]#illegitimate-use-name#
|Using the name of an institution without permission to do so.

|[stixliteral]#illegitimate-use-resources#
|Use of institutional resources for purposes other than those intended.

|[stixliteral]#infected-by-known-malware#
|The presence of any of the types of malware was detected in a system.

|[stixliteral]#insufficient-data#
|Not enough data is available to assess this event.

|[stixliteral]#modification-information#
|Unauthorized changes to a specific set of information.

|[stixliteral]#misconfiguration#
|A false positive where this event was triggered by a misconfiguration. 

|[stixliteral]#natural#
|The event was due to natural causes such as an earthquake or hurricane.

|[stixliteral]#network-scanning#
|Scanning a network aimed at identifying systems which are active in the same network.

|[stixliteral]#packet-flood#
|Mass mailing of requests (network packets, emails, etc...) from various sources to a specific service, aimed at affecting its normal functioning.

|[stixliteral]#password-cracking-attempt#
|Attempt to acquire access credentials by breaking the protective cryptographic keys.

|[stixliteral]#refuted#
|The event was previously suspected to have achieved a goal, but this has since been refuted.

|[stixliteral]#scan-probe#
|Event was triggered based on scanning activity

|[stixliteral]#silently-discarded#
|The event was silently discarded due to resource constraints, information types or external reasons.

|[stixliteral]#spam#
|Sending an email message that was unsolicited or unwanted by the recipient.

|[stixliteral]#sql-injection#
|Manipulation or reading of information contained in a database by using the SQL injection technique.

|[stixliteral]#sql-injection-attempt#
|Unsuccessful attempt to manipulate or read the information of a database by using the SQL injection technique.

|[stixliteral]#succesful#
|The event is believed to have succeeded in its goal.

|[stixliteral]#system-probe#
|Single system scan searching for open ports or services using these ports for responding.

|[stixliteral]#theft-access-credentials#
|Unauthorized access to a system or component by using stolen access credentials.

|[stixliteral]#unauthorized-access-information#
|Unauthorized access to a set of information.

|[stixliteral]#unauthorized-access-system#
|Unauthorized access to a system or component.

|[stixliteral]#undetermined#
|Field aimed at the classification of unprocessed events, which have remained undetermined from the beginning.

|[stixliteral]#unintentional#
|The event was due to unintentional activity.

|[stixliteral]#unspecified#
|Other unlisted events.

|[stixliteral]#vandalism#
|Logical and physical activities which – although they are not aimed at causing damage to information or at preventing its transmission among systems – have this effect.

|[stixliteral]#wiretapping#
|Logical or physical interception of communications.

|[stixliteral]#worm-spreading#
|System infected by a worm trying to infect other systems.

|[stixliteral]#xss#
|Attacks performed with the use of cross-site scripting techniques.

|[stixliteral]#xss-attempt#
|Unsuccessful attempts to perform attacks by using cross-site scripting techniques.

|===

<<<

=== 3.2 State Change Type Vocabulary

*Type Name*: [stixtype]#state-change-type-ov#

[width="100%",cols="31%,69%",options="header",]
|===
^|[stixtr]*Vocabulary Value* ^|[stixtr]*Description*

|[stixliteral]#caused#
|This task or event is the primary cause of the resulting object.

|[stixliteral]#contributed-to#
|This task or event is a contributing factor to the result occurring.

|[stixliteral]#mitigated#
|This task or event lessened the severity of the initial object.

|[stixliteral]#resolved#
|This task or event resolved the initial object.

|===
<<<
== 4. Enumerations

=== 4.1 Event Status Enumeration

*Type Name*: [stixtype]#event-status-enum#

[width="100%",cols="28%,72%",options="header",]
|===
^|[stixtr]*Vocabulary Value* ^|[stixtr]*Description*

|[stixliteral]#ongoing#
|The event is still occurring.

|[stixliteral]#occurred#
|The event took and is no longer ongoing.

|[stixliteral]#not-occurred#
|The event did not take place, but it was previously expected to.

|[stixliteral]#pending#
|The event has not yet been started or observed, but it is projected or otherwise planned. 

Pending activity may never occur as various factors can cause it to be blocked or not attempted.
As such any time or sequence values for pending activities should be treated as an estimation or projection that is subject to change.

|[stixliteral]#undetermined#
|The status of the event has not been determined or is not shareable.
|===

<<<

=== 4.2 Timestamp Fidelity Enumeration

*Type Name*: [stixtype]#timestamp-fidelity-enum#

[width="100%",cols="31%,69%",options="header",]
|===
^|[stixtr]*Vocabulary Value* ^|[stixtr]*Description*
|[stixliteral]#day#
|The associated timestamp should be considered to represent a time within the one day period starting with the provided timestamp.

Hours and minutes should be understood to establish the timezone for this activity.

|[stixliteral]#hour#
|The associated timestamp should be considered to represent a time within the one hour period starting with the provided timestamp.

|[stixliteral]#minute#
|The associated timestamp should be considered to represent a time within the one minute period starting with the provided timestamp.

|[stixliteral]#month#
|The associated timestamp should be considered to represent a time within the one month period starting with the provided timestamp.

Hours and minutes should be understood to establish the timezone for the activity.
The day should always be listed as the first or the last day of the previous month if in a timezone that is offset before UTC.

|[stixliteral]#second#
|The associated timestamp should be considered to represent a time within the one second period starting with the provided timestamp.

|[stixliteral]#year#
|The associated timestamp should be considered to represent a time within the one year period starting with the provided timestamp.

Hours and minutes should be understood to establish the timezone for the activity.

|===

<<<

== 5.0 Relationships

[width="100%",cols="23%,20%,24%,33%",options="header",]
|===
4+^|[stixtr]*Common Relationships*
4+|[stixrelationship]#derived-from#,
[stixrelationship]#duplicate-of#,
[stixrelationship]#related-to#

|*Source* |*Type* |*Target* |*Description*

|[stixtype]*event* 
|[stixrelationship]#led-to#
|[stixtype]*event* 
|One event led to another.
For example a dropper running allowed a ransomware tool to be downloaded and run.

|[stixtype]*event*
|[stixrelationship]#impacted#
|[stixtype]*infrastructure*, +
<All STIX Cyber-observable Objects>
|The event impacts infrastructure or other resources that are identified by cyber-observable objects.

|[stixtype]*event*
|[stixrelationship]#located-at#
|[stixtype]*location*
|The event occurred at a specific location or locations.

|[stixtype]*event*
|[stixrelationship]#observed#
|<All STIX Cyber-observable Objects>
|STIX cyber-observables were observed as part of this event, but no information on when they are observed is being shared.

If this can be shared a Sighting it should be instead of using this method.
|===

<<<

[width="100%",cols="23%,20%,24%,33%",options="header",]
|===
4+^|[stixtr]*Reverse Relationships*

|*Source* |*Type* |*Target* |*Description*

|[stixtype]*indicator*
|[stixrelationship]#based-on#
|[stixtype]*event*
|An indicator is based on an event.

|[stixtype]*malware*
|[stixrelationship]#performed#
|[stixtype]*event*
|Malware performed a specific event.

|[stixtype]*tool*
|[stixrelationship]#performed#
|[stixtype]*event*
|A tool performed a specific event.
|===

<<<

== Appendix A. Revision History

[width="100%",cols="18%,16%,23%,43%",options="header",]
|===
^|[stixtr]*Revision* ^|[stixtr]*Date* ^|[stixtr]*Editor* ^|[stixtr]*Changes Made*
|01
|<TBD>
|Incident Mini Group
|Initial Version

|===