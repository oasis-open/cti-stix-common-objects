{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://raw.githubusercontent.com/oasis-open/cti-stix-common-objects/main/extension-definition-specifications/malware-behavior/malware-extension.json",
    "title": "Malware extension for Malware Behavior",
    "description": "Extension to the malware object to support Malware Behavior",
    "properties": {
	"extension_type": {
	    "type": "string",
	    "enum": [
		"property-extension"
	    ]
	},
	"obj_defn": {
	    "$ref": "https://raw.githubusercontent.com/oasis-open/cti-stix-common-objects/main/extension-definition-specifications/malware-behavior/object-definition.json"
	},
	"year": {
	    "description": "This property denotes the year the malware instance or family was first seen.",
	    "type": "string",
	    "pattern": "^\\d{4}$"
	},
	"platforms": {
	    "description": "This property denotes the operating system affected by the malware. The values for this property SHOULD come from the os-type-ov open vocabulary.",
	    "type": "array",
	    "item": {
		"type": "string"
	    },
	    "minItems": 1,
	    "$comment": "not required, but if used, there must be 1 item"
	}
    },
    "required": [
	"obj_defn"
    ],
    "definitions": {
	"os-type-ov": {
	    "type": "string",
	    "enum": [
		"android",
		"ios",
		"linux",
		"macos",
		"windows"
	    ]
	}
    }
}
